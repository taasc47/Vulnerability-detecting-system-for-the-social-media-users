# -*- coding: utf-8 -*-
"""
Created on Sun Oct  3 13:52:34 2021

@author: THISUM PC
"""

import pandas as pd
from sklearn.preprocessing import LabelEncoder 

#------------------------read the data----------------------------------#

data=pd.read_excel('data.xlsx', index_col=0, header=0)

Features=data.columns

tot_data=len(data)
print('data length:',tot_data)
print(data.shape)
print('X:',data.values[:5,0:7])
print(Features)

#------------------------- Lebel the data -----------------------------#

Percentage=[]
label=[]

def percentage(i):
    percent=0
    if data[Features[0]][i]>2000:   #Connections
        percent=percent+0.25
        
    if data[Features[1]][i]>12:   #Experience
        percent=percent+0.1
    
    if data[Features[2]][i]==0:   #Attacks
        percent=percent+0.1
        
    if data[Features[3]][i]==0:   #Authentication
        percent=percent+0.1
        
    if data[Features[4]][i]==0:   #Awareness
        percent=percent+0.1
        
    if data[Features[5]][i]>6:    #Time
        percent=percent+0.25
        
    if data[Features[6]][i]>250:   #Involvement
        percent=percent+0.1
       
    return percent
    

for i in range(1,tot_data+1):
    
    Percentage.append(percentage(i))
    if percentage(i)<=0.3:
        label.append('Low')
    elif percentage(i)>0.3 and percentage(i)<=0.6:
        label.append('Medium')
    else:
        label.append('High')
    



data['Percentage']=Percentage
data['Label']=label   

print(data.head())

#----------------------- Writing to an excel sheet -------------------------#

writer=pd.ExcelWriter('new_book.xlsx')
data.to_excel(writer,'new_sheet',float_format="%.2f",index_label=0)

workbook=writer.book
worksheet=writer.sheets['new_sheet']

format1 = workbook.add_format({'num_format': '#,##0'})
format2 = workbook.add_format({'num_format': '0%'})

worksheet.set_column('C:C', 10, format1)
worksheet.set_column('D:D', 10, format1)
worksheet.set_column('E:E', 10, format1)
worksheet.set_column('F:F', 13, format1)
worksheet.set_column('G:G', 10, format1)
worksheet.set_column('H:H', 12, format1)

worksheet.set_column('I:I', 12, format2)

writer.save()


    










